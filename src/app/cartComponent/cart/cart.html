<div class="container mx-auto px-4 py-6">
  <!-- Page Header -->
  <div class="flex items-center justify-center gap-2 mb-8">
    <mat-icon
      [matBadge]="cartCount$ | async"
      matBadgeColor="warn"
      class="text-5xl text-green-600"
    >
      shopping_cart
    </mat-icon>
    <h1 class="text-3xl font-bold">
      Your Shopping Cart ({{ cartCount$ | async }})
    </h1>
  </div>

  <!-- Cart Items -->
  <div
    *ngIf="cartItems$ | async as cartItems; else emptyCart"
    class="flex flex-col gap-6"
  >
    <mat-card
      *ngFor="let item of cartItems"
      class="flex flex-col md:flex-row items-center md:items-start p-6 bg-white shadow-lg rounded-xl hover:shadow-2xl transition-shadow"
    >
      <!-- Product Image -->
      <img
        [src]="item.image"
        alt="{{ item.title }}"
        class="w-full md:w-32 h-32 object-contain rounded-lg shadow-sm mb-4 md:mb-0 md:mr-6"
      />

      <!-- Product Info -->
      <div class="flex-1 flex flex-col justify-between w-full">
        <div>
          <h2 class="text-lg font-semibold">{{ item.title }}</h2>
          <p class="text-gray-600 mt-1 line-clamp-3">{{ item.description }}</p>
        </div>

        <!-- Quantity & Price -->
        <div class="flex justify-between items-center mt-4 md:mt-6">
          <div class="flex items-center gap-2">
            <button
              mat-mini-fab
              color="primary"
              aria-label="Decrease"
              (click)="decreaseQuantity(item)"
              class="hover:bg-blue-600 transition-colors"
            >
              <mat-icon>remove</mat-icon>
            </button>
            <span class="px-3 text-lg font-medium">{{ item.quantity }}</span>
            <button
              mat-mini-fab
              color="primary"
              aria-label="Increase"
              (click)="increaseQuantity(item)"
              class="hover:bg-blue-600 transition-colors"
            >
              <mat-icon>add</mat-icon>
            </button>
            <!-- Remove Button -->
            <button
              mat-icon-button
              color="warn"
              class="ml-auto md:ml-6 mt-4 md:mt-0"
              (click)="removeFromCart(item)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
          <div class="text-lg font-semibold text-gray-800">
            ${{ item.price * item.quantity }}
          </div>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Empty Cart Template -->
  <ng-template #emptyCart>
    <div class="flex flex-col items-center justify-center mt-20 gap-4">
      <mat-icon class="text-8xl text-gray-400">shopping_cart</mat-icon>
      <p class="text-gray-500 text-xl">Your cart is empty.</p>
      <a
        routerLink="/products"
        class="px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors"
      >
        Shop Now
      </a>
    </div>
  </ng-template>

  <!-- Checkout Summary -->
  <mat-card
    *ngIf="cartItems$ | async as cartItems"
    class="mt-8 p-6 rounded-xl shadow-lg flex flex-col md:flex-row justify-between items-center bg-gray-50 gap-4 md:gap-0"
  >
    <div class="text-xl font-semibold">Total: ${{ getTotal() }}</div>
    <button
      mat-raised-button
      color="accent"
      class="px-6 py-3 w-full md:w-auto"
      (click)="checkout()"
    >
      Proceed to Checkout
    </button>
  </mat-card>
</div>
